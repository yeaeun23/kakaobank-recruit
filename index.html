<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./style/reset.css" />
    <link rel="stylesheet" href="./style/index.css" />
    <link rel="shortcut icon" href="favicon.gif" type="image/x-icon" />
    <title>카카오뱅크 인재영입</title>
  </head>

  <body>
    <div id="main-img-wrapper">
      <img width="320" src="./img/02-img-hands.49cd2bd35e71288bc5d65f7c7fd43ed9.png" />
    </div>
    <div id="intro-main">
      <p>이미 모두의 은행 카카오뱅크,</p>
      <p>함께 일해요.</p>
      <p id="join-us-text">Join us!</p>
      <img id="down-arrow-icon" src="./img/02-arrow-56.2fa858a30b7a3ffc9a30eccc26a6e164.svg" />
    </div>
    <ul id="list-item-wrapper">
      <li class="list-item">26주적금</li>
      <li class="list-item">저금통</li>
      <li class="list-item">비상금대출</li>
      <li class="list-item">입출금통장</li>
      <li class="list-item">세이프박스</li>
      <li class="list-item">자유적금</li>
      <li class="list-item">정기예금</li>
      <li class="list-item">내신용정보</li>
      <li class="list-item">실험실</li>
      <li class="list-item">마이너스통장대출</li>
      <li class="list-item">휴면예금/보험금찾기</li>
      <li class="list-item">개인사업자대출</li>
      <li class="list-item">해외송금받기</li>
      <li class="list-item">인증</li>
      <li class="list-item">간편이체</li>
      <li class="list-item">전월세보증금대출</li>
      <li class="list-item">프렌즈체크카드</li>
      <li class="list-item">모임통장</li>
      <li class="list-item">카카오뱅크mini</li>
      <li class="list-item">신용대출</li>
      <li class="list-item">증권사주식계좌</li>
      <li class="list-item">제휴신용카드</li>
      <li class="list-item">연계대출</li>
      <li class="list-item">개인사업자뱅킹</li>
      <li class="list-item">기록통장</li>
      <li class="list-item">개인금고</li>
      <li class="list-item">혜택좋은신용카드</li>
      <li class="list-item">중고차구매대출</li>
      <li class="list-item">쿠폰사고팔기</li>
      <li class="list-item">한달적금</li>
      <li class="list-item">신용대출비교하기</li>
    </ul>
    <main>
      <section id="panel1-img">
        <img id="ryan-img" src="./img/03-img-ryan.5d2862452730274c1b0bed7dc8fde575.png" />
      </section>
      <section id="video-section">
        <div id="fixed-wrapper">
          <video id="video" src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4" type="video/mp4" muted loop></video>
          <div id="fixed-description">
            <img src="./img/invalid-tit.webp" alt="혁신이 만든 압도적인 성장" />
          </div>
        </div>
      </section>
      <div id="bank-beyond-wrapper">
        <div id="bank-beyond">
          <img width="315" src="./img/05-text.webp" alt="Bank, Beyond Bank" />
        </div>
      </div>
      <div id="white-wrapper">
        <div id="slider-container">
          <div id="slider-content-wrapper">
            <div id="slider-content">
              <img src="https://picsum.photos/id/1/600/933" class="slider-image" />
              <img src="https://picsum.photos/id/59/600/933" class="slider-image" />
              <img src="https://picsum.photos/id/89/600/933" class="slider-image" />
            </div>
          </div>
          <div class="slider-button" id="left-button">&lt;</div>
          <div class="slider-button" id="right-button">&gt;</div>
          <div id="slider-index">1/3</div>
        </div>
      </div>
    </main>
  </body>

  <script>
    const listItemWrapper = document.getElementById("list-item-wrapper");
    const listItems = document.querySelectorAll(".list-item"); // 31개

    let listStyleChangeStartY = listItemWrapper.offsetTop - 550;
    let listStyleChangeEndY = listItemWrapper.offsetTop + listItemWrapper.offsetHeight - 550;
    let division = (listStyleChangeEndY - listStyleChangeStartY) / listItems.length;

    // 화면 리사이즈 이벤트 (반응형)
    window.addEventListener("resize", () => {
      listStyleChangeStartY = listItemWrapper.offsetTop - 550;
      listStyleChangeEndY = listItemWrapper.offsetTop + listItemWrapper.offsetHeight - 550;
      division = (listStyleChangeEndY - listStyleChangeStartY) / listItems.length;
    });

    const panel1Img = document.getElementById("panel1-img");
    const ryanImg = document.getElementById("ryan-img");

    const videoSection = document.getElementById("video-section");
    const fixedWrapper = document.getElementById("fixed-wrapper");
    const video = document.getElementById("video");
    const videoPlayBack = 500;

    video.addEventListener("loadedmetadata", () => {
      videoSection.style.height = video.duration * videoPlayBack + "px";
    });

    const fixedDescription = document.getElementById("fixed-description");
    const fixedDescriptionAppearTiming = 3700;
    const fixedDescriptionAppearEnds = 3800;

    // 스크롤 이벤트
    window.addEventListener("scroll", () => {
      // 리스트 on 스타일
      if (document.getElementById("on")) {
        document.getElementById("on").removeAttribute("id");
      }

      if (window.scrollY > listStyleChangeStartY && window.screenY < listStyleChangeEndY) {
        const targetIndex = Math.round((window.scrollY - listStyleChangeStartY) / division);

        if (listItems[targetIndex]) {
          listItems[targetIndex].id = "on";
        }
      }

      // 라이언 이미지 회전
      const scrollYBottom = window.scrollY + document.documentElement.clientHeight;

      if (scrollYBottom > panel1Img.offsetTop && scrollYBottom < panel1Img.offsetTop + panel1Img.offsetHeight + 100) {
        const ratio = (scrollYBottom - panel1Img.offsetTop) / (panel1Img.offsetHeight + 100);
        const translateX = 80 - 80 * 1.3 * ratio;
        const translateY = -13 + 13 * ratio;
        const rotaionDegree = 23 - 23 * 1.7 * ratio;

        ryanImg.style.transform = `translate(${translateX}px, ${translateY}px) rotate(${rotaionDegree}deg)`;
      }

      // 화면 가운데 고정
      function centerElement(elementId, video) {
        const element = document.getElementById(elementId);
        const parent = element.parentElement;

        // 요소가 화면 중간에 왔을 때
        if (window.scrollY > parent.offsetTop - (document.documentElement.clientHeight - element.offsetHeight) / 2) {
          // 화면 가운데 고정 시작
          element.style.position = "fixed";
          element.style.top = "50%";
          element.style.left = "50%";
          element.style.transform = "translate(-50%,-50%)";

          // 비디오 재생
          if (video) {
            video.currentTime = (window.scrollY - videoSection.offsetTop) / videoPlayBack;
          }
        } else {
          // 되돌리기
          element.style.position = "relative";
          element.style.top = "initial";
          element.style.left = "initial";
          element.style.transform = "initial";
        }
      }

      centerElement("bank-beyond");
      centerElement("fixed-wrapper", video);

      if (window.scrollY > videoSection.offsetTop + videoSection.offsetHeight - fixedWrapper.offsetHeight - (document.documentElement.clientHeight - fixedWrapper.offsetHeight) / 2) {
        // 되돌리기
        fixedWrapper.style.position = "relative";
        fixedWrapper.style.top = "initial";
        fixedWrapper.style.left = "initial";
        fixedWrapper.style.transform = `translateY(${videoSection.offsetHeight - fixedWrapper.offsetHeight}px)`;
      }

      // 텍스트 이미지 올라오는 효과
      if (window.scrollY > fixedDescriptionAppearTiming && window.scrollY < fixedDescriptionAppearEnds) {
        fixedDescription.style.transform = `translateY(${fixedDescriptionAppearEnds - window.scrollY}px)`;
        fixedDescription.style.opacity = (window.scrollY - fixedDescriptionAppearTiming) / 300;
      } else if (window.scrollY > fixedDescriptionAppearEnds) {
        fixedDescription.style.transform = `translateY(0px)`;
        fixedDescription.style.opacity = 1;
      } else {
        fixedDescription.style.transform = `translateY(50px)`;
        fixedDescription.style.opacity = 0;
      }
    });

    // 슬라이드 이동 버튼 클릭 이벤트
    const sliderContentWrapper = document.getElementById("slider-content-wrapper");
    const sliderImages = document.querySelectorAll(".slider-image");
    const sliderIndex = document.getElementById("slider-index");
    let currentImage = 0;

    const handleSlideChange = (step) => {
      currentImage += step;

      // 슬라이드 맨앞/맨뒤로 처리
      if (currentImage < 0) {
        currentImage = sliderImages.length - 1;
      } else if (currentImage >= sliderImages.length) {
        currentImage = 0;
      }

      // 스크롤 강제 이동
      sliderContentWrapper.scrollLeft = sliderImages[currentImage].offsetLeft;
    };

    document.getElementById("left-button").addEventListener("click", () => {
      handleSlideChange(-1);
    });
    document.getElementById("right-button").addEventListener("click", () => {
      handleSlideChange(1);
    });

    // 슬라이드 (가로)스크롤 이벤트
    sliderContentWrapper.addEventListener("scroll", () => {
      const imageWidth = sliderImages[0].offsetWidth;

      // 스크롤 위치와 이미지 크기로 인덱스 계산
      currentImage = Math.round(sliderContentWrapper.scrollLeft / imageWidth);
      // 인덱스 표시
      sliderIndex.innerText = `${currentImage + 1}/${sliderImages.length}`;
    });
  </script>
</html>
